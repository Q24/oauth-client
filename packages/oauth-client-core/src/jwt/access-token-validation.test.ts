import { findAtHash } from "./access-token-validation";

const randomString =
  "q7BtoWSvA9TJdWV7bG2fvWshw7jChOzHXufj9e6NglL0kxK5XAWsYSAxUtWTusN0QmraPR5PsOV0yUNO8txnKVt99ouT0MIvMum4pJOle2WyQJyUeHZ8FP1EKnzwDjGYPi39jFbFpZMJJvnzSXkmyVa2hVDQ0Co4J4zVX5C819pSmgqbgIsPPOqAlj9Naqwg0V5pjlI46V45UmE8znnZ6HeqG7pBAVrhHDhCgZfhqd16PUeslf1L40o4XHR6wTNmyMCvYzdSS9SrCK0POZiT3B0dKmz4g5yjLKGJRnCca5c2N1gOlIWrLL2EFo8yhBWOnnCQtkASSYbLMPMmWLqcEa4o3kQq6EDQ6RAiOSL75njxZLxyBGLvLtE5ciq78mJ4y1zl2fSJbaaRlJtEbgF9OWrhw2rEu5q0C9OA3QefAFaxKXUI76G1oKYiGBglr20HxY1GvybuSLo7KcCMb93ZxabBRCyOnLGUlMvO60dKOukfwZ7jFmB9GrloOBMQA5GdclFDcaUjRVVkaYP2Mzr3wBD5cpByJ1yTF9DzkYlcclTajRo9aZ4u5FRyhYfQtazIJ9AEojfRglfFkcCqHYLHqysh2x1KdV7heOfsJz1vR2QFgAuPN506BzY1l3yEWxbbsh94PvnqaP260FBIAGiptCBz959qTzNuHqvvU1ryV1dILzPuzw7f5eAEkPmlwNuik9dtjJmtNfF0moi6fSXYuQTFhYWdBz1AS6XQR0sJdFf2ca00tcssRWYl8P75jv0Uc1auATkvhJu84NiT6Tl321ZYgkwF4uYHK4g4fcgIKxEFOBY4XL3JZxUPski10bGos1K1F80A3mEnI37cjaRnxa2ayZr4hDBNun1N5yiLlGuMkdX1AFDF9xzvXl09Mz4pKVZDRKQbLqfoq6KsdsxzRRtOJ9831EtsKHs3V3JfO5xGGBTsg6MYEahE1s1Zc7v3f6smjQr8St6LloTjyLgf7sFvOrNBQO24q5NqMmG8";

it("returns the right at_hash", async () => {
  const atHash = await findAtHash(randomString, "sha256");

  expect(atHash).toBe("wJNzq_CTUxNYPIyYGisyow");
});
